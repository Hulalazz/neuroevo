
obj_fns = {
  # MINIMIZATION: upper parabolic with minimum in [0]*ndims
  :min => lambda do |inds|
    inds.collect do |ind|
      ind.inject(0) do |mem, var|
        mem + var**2
      end
    end
  end,

  # MAXIMIZATION: lower parabolic with maximum in [0]*ndims
  :max => lambda do |inds|
    inds.collect do |ind|
      ind.inject(0) do |mem, var|
        mem - var**2
      end
    end
  end
}
opt_types=obj_fns.keys


ndims = 5
m = {
  #### Algorithm constants
  opt_type: :max,
  obj_fn: obj_fns[:max],
  id: NMatrix.identity(ndims),

  #### Optimized parameters
  ndims: ndims,
  popsize: 16,
  lrate: 0.412281,
  util: NMatrix[
    [-0.0625, -0.0625, -0.0625, -0.0625, -0.0625, -0.0625, -0.0625,
     -0.0625, -0.0625, -0.0625, -0.0322519, 0.00352402, 0.0473102,
      0.10376, 0.183322, 0.319335]],

  #### Algorithm initialization
  init_mu: NMatrix.zeros(ndims),
  init_log_sigma: NMatrix.identity(ndims),
  init_sigma:  NMatrix.identity(ndims) * 2.71828,

  #### Search state after 3 generations

  mu: NMatrix[
    [-0.0722648, 0.471888, -0.633824, -0.0238598, 0.215852]],

  log_sigma: NMatrix[
    [0.561554, 0.0451679, 0.116178, -0.0566093, 0.0520955],
    [0.0451679, 0.6414, -0.023034, -0.00777936, 0.0556042],
    [0.116178, -0.023034, 0.587412, -0.0255132, 0.0858725],
    [-0.0566093, -0.00777936, -0.0255132, 0.564742, 0.123054],
    [0.0520955, 0.0556042, 0.0858725, 0.123054, 0.33955]],

  sigma: NMatrix[
    [1.77243, 0.0831829, 0.211237, -0.097317, 0.0870789],
    [0.0831829,1.90417, -0.0336519, -0.0103613, 0.091144],
    [0.211237, -0.0336519,1.8187, -0.0425435, 0.13904],
    [-0.097317, -0.0103613, -0.0425435, 1.77457,0.19004],
    [0.0870789, 0.091144, 0.13904, 0.19004, 1.42587]],

  #### Individual generation, evaluation and sorting

  samples: NMatrix[
    [-1.46064, -0.375224, -0.656053, 1.21188, -0.838443],
    [-1.24387, 2.51843,0.0814548, -3.26914, -0.935669],
    [0.214327,0.362019, -1.63861, -0.293707, -1.0089],
    [2.2411, -0.97866, -0.80782, -1.26539, 0.476362],
    [-0.017185, 0.650769, 1.73625,0.0242154, -0.21539],
    [0.183909, 0.467122, 1.23359, -0.886437,1.17343],
    [-0.711852, 0.476667, -0.342549, -0.564154,0.781954],
    [-0.420505, -1.23817, -1.4762, -0.813103,0.597991],
    [0.437641, -0.515891, -1.10436, -0.692001, 1.66246],
    [0.101681,0.114965, 1.41675, 2.19553, -1.06271],
    [0.76503, 0.9, 0.160478, -0.277011,0.647586],
    [0.138482, -2.61122, -1.2303, -0.471865, -0.723405],
    [1.88692, -0.00442256, -0.202205, 2.0715, 0.730549],
    [-0.293479, 0.829926, 0.0437524,1.50639, -1.68192],
    [0.354887, 0.542859, -0.708161, 0.96674,0.876119],
    [-1.56902, -1.35213, 0.702417, 0.757346, 1.18893]],

  inds: [
    [-3.0219, -0.431, -2.29103, 2.14131, -1.00196],
    [-1.81359,5.10978, -0.824199, -5.9115, -1.60701],
    [-0.0676774,1.14529, -3.70865, -0.69169, -1.45469],
    [3.81251, -1.12151, -1.4766, -2.35243, 0.648242],
    [0.297056, 1.63132, 2.46737, -0.100757,0.212562],
    [0.741584, 1.45129, 1.83369, -1.44912, 1.95066],
    [-1.24369,1.40897, -1.2905, -0.797477,1.15743],
    [-1.1012, -1.80816, -3.24801, -1.23657,0.559266],
    [0.639338, -0.278192, -2.27193, -0.92619, 2.29233],
    [0.110589,0.531974, 1.71926, 3.59894, -0.665879],
    [1.47581,2.30577, -0.108822, -0.48297,1.25754],
    [-0.320981, -4.50842, -2.83475, -0.932772, -1.3023],
    [3.09112,0.672353, -0.589391, 3.616, 1.78698],
    [-0.807216, 1.85741, -0.942115,2.3478, -1.8399],
    [0.434526, 1.62877, -1.78437, 1.84815,1.63072],
    [-2.78751, -2.15643, 0.490817, 1.68287, 1.89283]],

  fits: [-20.1556, -67.6065, -17.6649, -23.9275, -8.89271, -11.9236,
         -7.17298, -16.8735, -11.7604, -16.6468, -9.3211, -31.0307,
         -26.6232, -13.8866, -12.1006, -19.0761],

  order: [2, 12, 13, 4, 1, 16, 3, 8, 10, 14, 15, 6, 9, 11, 5, 7],

  sorted: NMatrix[
    [-1.24387, 2.51843,0.0814548, -3.26914, -0.935669],
    [0.138482, -2.61122, -1.2303, -0.471865, -0.723405],
    [1.88692, -0.00442256, -0.202205, 2.0715,0.730549],
    [2.2411, -0.97866, -0.80782, -1.26539,0.476362],
    [-1.46064, -0.375224, -0.656053,1.21188, -0.838443],
    [-1.56902, -1.35213, 0.702417, 0.757346,1.18893],
    [0.214327,0.362019, -1.63861, -0.293707, -1.0089],
    [-0.420505, -1.23817, -1.4762, -0.813103, 0.597991],
    [0.101681, 0.114965, 1.41675,2.19553, -1.06271],
    [-0.293479, 0.829926, 0.0437524,1.50639, -1.68192],
    [0.354887, 0.542859, -0.708161, 0.96674,0.876119],
    [0.183909, 0.467122, 1.23359, -0.886437,1.17343],
    [0.437641, -0.515891, -1.10436, -0.692001, 1.66246],
    [0.76503,0.9, 0.160478, -0.277011, 0.647586],
    [-0.017185, 0.650769, 1.73625,0.0242154, -0.21539],
    [-0.711852, 0.476667, -0.342549, -0.564154, 0.781954]],

  #### Gradient computation

  gmu: NMatrix[
    [-0.11587, 0.495538, 0.435921, -0.373339, 0.53552]],

  glogsigma: NMatrix[
    [-0.713777, 0.110687,0.209096, -0.0557682, -0.274692],
    [0.110687, -0.915274, -0.0973469,0.192618, 0.403169],
    [0.209096, -0.0973469,0.0139897, -0.225343, -0.258664],
    [-0.0557682,0.192618, -0.225343, -1.5626, -0.191995],
    [-0.274692,0.403169, -0.258664, -0.191995, -0.242475]],

  #### Updated distribution

  newmu: NMatrix[
    [-0.0677724, 0.872606, -0.286684, -0.260158, 0.54086]],

  newlogsigma: NMatrix[
    [0.414416, 0.0679849, 0.159281, -0.0681053, -0.00452956],
    [0.0679849,0.452725, -0.0431011, 0.0319271, 0.138714],
    [0.159281, -0.0431011,0.590296, -0.0719654, 0.0325514],
    [-0.0681053, 0.0319271, -0.0719654,0.242626, 0.0834758],
    [-0.00452956, 0.138714, 0.0325514, 0.0834758,0.289566]],

  newsigma: NMatrix[
    [1.54089, 0.0980732, 0.266672, -0.10265, 0.0000591981],
    [0.0980732,1.59265, -0.0629521, 0.052536, 0.203015],
    [0.266672, -0.0629521,1.83287, -0.117849, 0.0416333],
    [-0.10265, 0.052536, -0.117849, 1.28713,0.111117],
    [0.0000591981, 0.203015, 0.0416333, 0.111117, 1.35483]]
}
